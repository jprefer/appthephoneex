define(['require', 'app'],
    function(require, APP) {
        /**
         * Controller for old_Buyer_Home generated by Appery.io
         * @module old_Buyer_Home
         */
        APP.controller('old_Buyer_Home', ['$scope', 'Apperyio', controller]);

        function controller($scope, Apperyio) {
            /**
             * user controller variables
             */
            $scope.Bid = Apperyio.EntityAPI('Bid');
            $scope.user = Apperyio.EntityAPI('User');
            $scope.BidModel = Apperyio.EntityAPI('String');
            $scope.BidMem = Apperyio.EntityAPI('String');
            $scope.BidColor = Apperyio.EntityAPI('String');
            $scope.BidQuan = Apperyio.EntityAPI('String');
            $scope.customPizza = Apperyio.EntityAPI('Object');
            $scope.customList = Apperyio.EntityAPI('Array');
            $scope.selected = Apperyio.EntityAPI('Wrapper');
            $scope.list = Apperyio.EntityAPI('List');
            /**
             * User controller functions
             */
            /**
             * @function init
             */
            $scope.init = function() {
                //On load screen logic
                $scope.customPizza.price = 0;
                $scope.customPizza.consist = [];
                var requestData = {};
                /*|button_mapping|onbeforesend|6A71953F-CA43-34BC-C5E5-604C42CE6608||6767|*/
                // read more about using rest services: https://links.appery.io/ve-snippet-rest
                Apperyio.get("PizzaDatabase_Ingredients_list_service")(requestData).then(
                    /*|service_bookmark|bookmark|6A71953F-CA43-34BC-C5E5-604C42CE6608||4946|*/
                    function(success) { // success callback
                        (function mapping3905(success, $scope) {
                            var list_scope = $scope.list;
                            var selected_scope = $scope.selected;
                            list_scope = success.data;
                            _.set(selected_scope, 'item', success.data[0]);
                            $scope.list = list_scope;
                            $scope.selected = selected_scope;
                            /*|button_mapping|onsuccess|6A71953F-CA43-34BC-C5E5-604C42CE6608||3905|*/
                        })(success, $scope);
                    },
                    function(error) { // callback to handle request error
                    },
                    function(notify) { // notify callback, can fire few times
                    });
            };
            /**
             * @function addItem
             */
            $scope.addItem = function() {
                $scope.customList.push($scope.selected.item);
                $scope.customPizza.price += $scope.selected.item.price;
                $scope.customPizza.consist.push($scope.selected.item.name);
            };
            /**
             * @function savePizza
             */
            $scope.savePizza = function() {
                $scope.customPizza.about = "Custom pizza";
                $scope.customPizza.name = "Custom pizza name";
                var requestData = {};
                requestData = (function mapping8736($scope) {
                    var requestData = {};
                    requestData.data = {};
                    var customPizza_scope = $scope.customPizza;
                    requestData.data = customPizza_scope;
                    return requestData;
                    /*|button_mapping|onbeforesend|FA450043-CFA6-BCE1-3343-014E7AEDDB6C||8736|*/
                })($scope);
                // read more about using rest services: https://links.appery.io/ve-snippet-rest
                Apperyio.get("PizzaDatabase_CustomPizza_create_service")(requestData).then(
                    /*|service_bookmark|bookmark|FA450043-CFA6-BCE1-3343-014E7AEDDB6C||8441|*/
                    function(success) { // success callback
                        /*|button_mapping|onsuccess|FA450043-CFA6-BCE1-3343-014E7AEDDB6C||2816|*/
                        var modalOptions = { // About Ionic Modal: https://links.appery.io/ve-snippet-modal-ionic
                            animation: 'slide-in-up', // The animation to show & hide with
                            focusFirstInput: false, // Whether to autofocus the first input of the modal when shown
                            backdropClickToClose: true, // Whether to close the modal on clicking the backdrop
                            hardwareBackButtonClose: true // Whether the modal can be closed using the hardware back button on Android and similar devices
                        };
                        Apperyio.get('Modals').loadModal("Info").then(
                            function(modalInstance) {
                                modalInstance.open(modalOptions).then(function(modal) {
                                    modal.scope.modal = modal;
                                    modal.scope.result = "Thank you! Your pizza recipe was successfully sent to us.";
                                    modal.show();
                                });
                            },
                            function(error) {
                                var modalOptions = { // About Ionic Modal: https://links.appery.io/ve-snippet-modal-ionic
                                    animation: 'slide-in-up', // The animation to show & hide with
                                    focusFirstInput: false, // Whether to autofocus the first input of the modal when shown
                                    backdropClickToClose: true, // Whether to close the modal on clicking the backdrop
                                    hardwareBackButtonClose: true // Whether the modal can be closed using the hardware back button on Android and similar devices
                                };
                                Apperyio.get('Modals').loadModal("Info").then(
                                    function(modalInstance) {
                                        modalInstance.open(modalOptions).then(function(modal) {
                                            modal.scope.modal = modal;
                                            modal.scope.result = "error";
                                            modal.show();
                                        });
                                    },
                                    function(error) {
                                        console.log(error);
                                    });
                                console.log(error);
                            });
                    },
                    function(error) { // callback to handle request error
                    },
                    function(notify) { // notify callback, can fire few times
                    });
            };
            /**
             * @function gotoPage
             */
            $scope.gotoPage = function() {
                Apperyio.navigateTo("TestBed", {});
            };
        }
    });