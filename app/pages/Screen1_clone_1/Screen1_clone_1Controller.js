define(['require', 'app'],
    function(require, APP) {
        /**
         * Controller for Screen1_clone_1 generated by Appery.io
         * @module Screen1_clone_1
         */
        APP.controller('Screen1_clone_1', ['$scope', 'Apperyio', controller]);

        function controller($scope, Apperyio) {
            /**
             * user controller variables
             */
            $scope.devID = Apperyio.EntityAPI('String');
            $scope.timeZone = Apperyio.EntityAPI('String');
            $scope.shift = Apperyio.EntityAPI('String');
            $scope.message = Apperyio.EntityAPI('String');
            $scope.channel = Apperyio.EntityAPI('String');
            /**
             * User controller functions
             */
            /**
             * @function init
             */
            $scope.init = function() {
                //On load screen logic
                //document.addEventListener("push-notification", function(event) {alert(event.detail.message);});
                //$scope.regPush();
                $scope.timeZone = "GMT-04:00";
                document.addEventListener("push-notification", function(event) {
                    alert(event.detail.message);
                });
                $scope.regPush();
            };
            /**
             * @function regPush
             */
            $scope.regPush = function() {
                var requestData = {};
                /*|button_mapping|onbeforesend|838C0496-7B6A-94CB-C133-467D83DC8CC7||2560|*/
                // read more about using rest services: https://links.appery.io/ve-snippet-rest
                Apperyio.get("PushRegisterDevice")(requestData).then(
                    /*|service_bookmark|bookmark|838C0496-7B6A-94CB-C133-467D83DC8CC7||6346|*/
                    function(success) { // success callback
                        (function mapping7833(success, $scope) {
                            var devID_scope = $scope.devID;
                            devID_scope = success.deviceID;
                            $scope.devID = devID_scope;
                            alert("Success. \n" + "Device ID: " + $scope.devID);
                            /*|button_mapping|onsuccess|838C0496-7B6A-94CB-C133-467D83DC8CC7||7833|*/
                        })(success, $scope);
                    },
                    function(error) { // callback to handle request error
                        alert("ERROR:\n" + JSON.stringify(error));
                    },
                    function(notify) { // notify callback, can fire few times
                    });
            };
            /**
             * @function sendPush
             */
            $scope.sendPush = function() {
                $scope.message = prompt("Enter your push text: ", "Test push");
                var requestData = {};
                requestData = (function mapping1884($scope) {
                    var requestData = {};
                    requestData.data = Apperyio.EntityAPI('PushSend.request.body', undefined, true);
                    console.log(requestData.data)
                    var mess_scope = $scope.mess;
                    requestData.data.payload.message = mess_scope;
                    return requestData;
                    /*|button_mapping|onbeforesend|0E74CFC2-73EE-DF0B-A3B5-D1F4C1B3FDED||1884|*/
                })($scope);
                // read more about using rest services: https://links.appery.io/ve-snippet-rest
                Apperyio.get("PushSend")(requestData).then(
                    /*|service_bookmark|bookmark|0E74CFC2-73EE-DF0B-A3B5-D1F4C1B3FDED||6816|*/
                    function(success) { // success callback
                        /*|button_mapping|onsuccess|0E74CFC2-73EE-DF0B-A3B5-D1F4C1B3FDED||4381|*/
                    },
                    function(error) { // callback to handle request error
                        alert("ERROR:n" + JSON.stringify(error));
                    },
                    function(notify) { // notify callback, can fire few times
                    });
            };
        }
    });